<script>
const API_URL = 'https://api.sheety.co/f7f2e9490f85889b2a23cbdcf031c17e/usersDb4/usersDb4';

async function loginUser() {
  const phone = document.getElementById("phone").value.trim();
  const password = document.getElementById("password").value.trim();

  document.body.innerHTML = "<h3>Checking login…</h3>";

  try {
    const res = await fetch(API_URL);
    const text = await res.text();
    console.log("Raw response:", text);

    if (!res.ok) {
      document.body.innerHTML = `<p style='color:red;'>❌ Sheety returned ${res.status}</p>`;
      return;
    }

    const data = JSON.parse(text);
    console.log("Parsed JSON:", data);

    const users = data.usersDb4 || [];
    const found = users.find(
      u => u.phone === phone && u.password === password
    );

    if (found) {
      document.body.innerHTML = `<h2>✅ Login Successful</h2>
      <p>Welcome, ${found.telegram || found.phone}</p>`;
    } else {
      document.body.innerHTML = `<p style='color:red;'>Invalid phone or password</p>`;
    }

  } catch (err) {
    console.error("Error:", err);
    document.body.innerHTML = `<p style='color:red;'>Error: ${err.message}</p>`;
  }
}
</script>
